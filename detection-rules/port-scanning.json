## File 7: `detection-rules/port-scanning.json`

**Commit Message:** `feat: add port scanning detection rule`

```json
{
  "rule_id": "nmap_port_scan_detection",
  "risk_score": 70,
  "severity": "medium",
  "description": "Detects port scanning activity using Nmap or similar tools",
  "type": "query",
  "query": "message: \"nmap\" OR message: \"PORT.*SCAN\" OR message: \"connect.*from.*port\" OR (process.name: nmap AND event.action: executed)",
  "index": [
    "filebeat-wsl-*"
  ],
  "aggregation": {
    "group_by": [
      "source.ip",
      "process.name"
    ],
    "agg_type": "cardinality",
    "agg_field": "destination.port",
    "time_window": "2m",
    "threshold": {
      "value": 10,
      "operator": "gt"
    }
  },
  "false_positives": [
    "Legitimate network scanning for administration",
    "Security testing activities"
  ],
  "tags": [
    "attack.t1046",
    "attack.discovery",
    "siem"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "name": "Discovery",
        "id": "TA0007"
      },
      "technique": [
        {
          "name": "Network Service Scanning",
          "id": "T1046"
        }
      ]
    }
  ],
  "note": "Detects both command execution and network connection patterns. WSL2 environment requires raw message parsing.",
  "interval": "2m",
  "from": "now-5m",
  "max_signals": 50
}
```

**Continue?**
