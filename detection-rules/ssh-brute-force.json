{
  "rule_id": "ssh_brute_force_detection",
  "risk_score": 80,
  "severity": "high",
  "description": "Detects SSH brute force attacks based on failed login threshold - WSL2 Optimized",
  "type": "query",
  "query": "message: \"Failed password*\" AND input.type: \"filestream\"",
  "index": [
    "filebeat-wsl-*"
  ],
  "aggregation": {
    "group_by": [
      "source.ip"
    ],
    "agg_type": "value_count",
    "agg_field": "@timestamp",
    "time_window": "2m",
    "threshold": {
      "value": 3,
      "operator": "gt"
    }
  },
  "false_positives": [
    "Legitimate users forgetting passwords"
  ],
  "tags": ["attack.t1190", "siem", "wsl2"],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "name": "Credential Access",
        "id": "TA0006"
      },
      "technique": [
        {
          "name": "Brute Force",
          "id": "T1110"
        }
      ]
    }
  ],
  "note": "Optimized for WSL2 - uses raw message field and lower threshold (3 attempts in 2 minutes)",
  "interval": "1m",
  "from": "now-5m"
}
