{
  "rule_id": "suspicious_execution_detection",
  "risk_score": 90,
  "severity": "critical",
  "description": "Detects suspicious script execution in /tmp directory - WSL2 Optimized",
  "type": "query",
  "query": "message.keyword: \"*COMMAND=/tmp/*\"",
  "index": [
    "filebeat-wsl-*"
  ],
  "aggregation": {
    "group_by": [
      "user.name"
    ],
    "agg_type": "value_count",
    "agg_field": "@timestamp",
    "time_window": "10m",
    "threshold": {
      "value": 1,
      "operator": "gt"
    }
  },
  "false_positives": [
    "Legitimate administrative scripts"
  ],
  "tags": ["attack.t1059", "siem", "wsl2", "malware"],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "name": "Execution",
        "id": "TA0002"
      },
      "technique": [
        {
          "name": "Command and Scripting Interpreter",
          "id": "T1059"
        }
      ]
    }
  ],
  "note": "WSL2 optimized - detects any command execution from /tmp directory. Single occurrence triggers alert.",
  "interval": "5m",
  "from": "now-10m"
}
