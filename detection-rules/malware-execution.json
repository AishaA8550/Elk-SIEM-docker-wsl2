{
  "rule_id": "suspicious_execution_detection",
  "risk_score": 90,
  "severity": "critical",
  "description": "Detects suspicious script execution in temporary directories - common malware behavior",
  "type": "query",
  "query": "message: \"/tmp/\" AND (message: \"COMMAND=\" OR process.working_directory: \"/tmp\" OR message: \"sudo.*/tmp/\") AND message: (\".sh\" OR \".py\" OR \".elf\" OR \"wget\" OR \"curl\")",
  "index": [
    "filebeat-wsl-*"
  ],
  "aggregation": {
    "group_by": [
      "user.name",
      "process.executable"
    ],
    "agg_type": "value_count",
    "agg_field": "@timestamp",
    "time_window": "10m",
    "threshold": {
      "value": 1,
      "operator": "gt"
    }
  },
  "false_positives": [
    "Legitimate administrative scripts",
    "Development environment activities"
  ],
  "tags": [
    "attack.t1059",
    "attack.execution",
    "siem",
    "malware"
  ],
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "name": "Execution",
        "id": "TA0002"
      },
      "technique": [
        {
          "name": "Command and Scripting Interpreter",
          "id": "T1059"
        }
      ]
    }
  ],
  "note": "WSL2 environment requires message field parsing. Rule focuses on /tmp directory executions which are common in malware.",
  "interval": "5m",
  "from": "now-10m",
  "max_signals": 25
}
